- !policy
  id: jenkins
  body:
  - &variables
    - !variable
      id: postgres/username
    - !variable
      id: postgres/password

  - &users
    - !user
      id: dkhan
    - !user
      id: jenkins_user

  - &groups
    - !group
      id: devops
    - !group 
      id: admins

  - !grant
    role: !group devops
    member: *users

  - !grant
    role: !group admins
    member: !group devops
  
  - !layer jenkins_hosts
  
  - !host-factory
    annotations:
      description: HostFactory for Jenkins_hosts
    layer: !layer jenkins_hosts

  - !permit
    role: !group devops
    privilege: [ read, execute, update ]
    resource: *variables

  - !permit
    role: !layer jenkins_hosts
    privilege: [ read, execute ]
    resource: *variables